// Generated by CoffeeScript 1.6.3
(function() {
  var SchoolMenuFile, fs, moment, path, regexpPattern;

  fs = require('fs');

  path = require('path');

  moment = require('moment');

  moment.lang('fr');

  regexpPattern = /\b(\d{4})-(\d{2})-(\d{2})-menu-?([\w-]*)?/;

  SchoolMenuFile = (function() {
    function SchoolMenuFile(basename, path, outPath) {
      var parameters, tags;
      this.path = path;
      this.outPath = outPath;
      if (!(parameters = basename.match(regexpPattern))) {
        throw "" + this.basename + " invalid filename : muste respect " + regexpPattern;
      }
      this.basename = parameters[0], this.year = parameters[1], this.month = parameters[2], this.day = parameters[3], tags = parameters[4];
      this.tags = tags ? tags.split('-') : void 0;
    }

    SchoolMenuFile.prototype.getTags = function() {
      return this.tags;
    };

    SchoolMenuFile.prototype.getDate = function() {
      return moment("" + this.year + "/" + this.month + "/" + this.day, "YYYY/MM/DD");
    };

    SchoolMenuFile.prototype.getExtension = function() {
      return path.extname(this.path);
    };

    SchoolMenuFile.prototype.getContent = function() {
      return fs.readFileSync(this.path, 'UTF-8');
    };

    SchoolMenuFile.prototype.getMeta = function() {
      var date, meta;
      date = this.getDate();
      return meta = {
        date: date.toDate(),
        tags: this.getTags(),
        menutags: this.getTags(),
        year: date.year(),
        month: date.month() + 1
      };
    };

    SchoolMenuFile.prototype.toString = function() {
      return "SchoolMenuFile(" + this.basename + ", " + this.path + ", " + this.outPath + ", " + this.year + ", " + this.month + ", " + this.day + ", " + this.tags + ")";
    };

    return SchoolMenuFile;

  })();

  module.exports = SchoolMenuFile;

}).call(this);
